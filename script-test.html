<!--

HTML, CSS, JS reference:
http://www.nematrian.com/Pages/HTMLCSSJSCombined.pdf

-->

<!--

Bug! Running the flipping code twice with different images, 
the first one somehow continues...

Also, the sanest speedup is probably going by columns
(whose count is obviously changable)

-->

<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<title></title>
<link href="all.css" rel="stylesheet">
</head>

<body>

<header>
Hi! Inverting! (indeed)
</header>

<script>

let str = '';
for (let i = 0; i < 4; i++) {
  str = str + i;
  document.write("...");
  document.write("<br>"); // This is necessary for an actual line break!
}

document.write(str);

</script>

This is an input thingy:

<input id="image-file" type="file" />

And that's it...

<script>
  function removeElement(elem) {
    // technically, just hides it
    elem.style.display = "none";
  }

  function chomp() {
    console.log(document.getElementById("image-file"));
    console.log(document.getElementById("image-file").value);
    document.getElementById("cheers").innerHTML="<br> You did it!!";
    window.alert("Testing alerts...");
    //removeElement(document.getElementById("image-file"));
  }

  document.getElementById("image-file").addEventListener("input", chomp);
</script>

<div id="cheers"> 
</div>





This was recommended at SO:

<input type="file" accept="image/*" onchange="loadFile(event)">
<img id="output"/>
<script>
  var loadFile = function(event) {
    var output = document.getElementById('output');
    // what does the URL mean?
    output.src = URL.createObjectURL(event.target.files[0]);
    output.onload = function() {
      URL.revokeObjectURL(output.src) // free memory
    }
  };
</script>

<br>

And here, I'll try to put it on a canvas (and draw over it):

<br>

<input type=file id="canvasInput"> 
<br>
<canvas id="cn"/>

<script>
  var canvas = document.getElementById('cn');
  var input = document.getElementById('canvasInput');
  var c2d = canvas.getContext('2d');

  input.onchange = function() {
    var img = new Image();
    img.onload = function() {
      document.getElementById("cheers").innerHTML="<br> Yay, at least the function runs!";
      canvas.width = this.width;
      canvas.height = this.height;
      c2d.drawImage(this, 0, 0);
      URL.revokeObjectURL(this.src);
      c2d.arc(100, 100, 44, 1, 2); // x, y, r, angle1, angle2
      c2d.stroke();

      var pixelData = c2d.getImageData(0, 0, canvas.width, canvas.height)

      console.log(pixelData);
      
      var i = 0;
      function step() {
        console.log(i);
        var imgData = c2d.createImageData(1,25);
        for (let j = 0; j < imgData.data.length; j++) {
          index = i * imgData.data.length + j;
          if (index % 4 != 3) {
            imgData.data[j] = 255 - pixelData.data[index];
          } else {
            imgData.data[j] = 255;
          }
        }
        c2d.putImageData(imgData, (i * 25) % canvas.width, Math.floor((i * 25) / canvas.width));

        i++;
        if (i * 25 < pixelData.data.length) {
          window.requestAnimationFrame(step); // starts the function again
        }
      }
      window.requestAnimationFrame(step);
    }
    img.src = URL.createObjectURL(this.files[0]);
  }

</script>

<footer>
Yee!
</footer>

</body></html>
